// To use the converter it is necessary to have: 
//    - .NET6
//    - the converter library (myCalibration.Converters.dll)
//    - Newtonsoft.Json nuget v13.0.1 https://www.nuget.org/packages/Newtonsoft.Json/


namespace ConverterUsageSample
{
    internal class Program
    {
        static void Main(string[] args)
        {
            var jsonText = File.ReadAllText("sample-data/PAA-9L_123021.1804_43345.json");

            KellerSensorDataExchange.KellerSensorData dataStoredInJsonFile = myCalibration.Converters.ConvertJsonToObject.Convert(jsonText);
            Console.WriteLine("This is the data from a " + dataStoredInJsonFile.Header.ProductType + " with serial number " + dataStoredInJsonFile.Header.SerialNumber + Environment.NewLine);

            Console.WriteLine("─────────────────────────────────────────────────────────────────────────────────────────────────────────────────");

            myCalibration.Converters.data_model.CalibrationDataAsTexts convertedData = myCalibration.Converters.MyCalibrationJsonConvert.JsonTextToAll(jsonText, separator:',');

            Console.WriteLine("The measurement data (Testrun) : " + Environment.NewLine + convertedData.MeasurementsTxtText + Environment.NewLine);
            Console.WriteLine("─────────────────────────────────────────────────────────────────────────────────────────────────────────────────");
            Console.WriteLine("The MathMod coefficient data   : " + Environment.NewLine + convertedData.CoefficientsTxtText + Environment.NewLine);

            Console.WriteLine("─────────────────────────────────────────────────────────────────────────────────────────────────────────────────");

            Console.WriteLine("The measurement data (Testrun) as CSV : " + Environment.NewLine + convertedData.MeasurementsCsvText + Environment.NewLine);
            Console.WriteLine("─────────────────────────────────────────────────────────────────────────────────────────────────────────────────");
            Console.WriteLine("The MathMod coefficient data   as CSV : " + Environment.NewLine + convertedData.CoefficientsCsvText + Environment.NewLine);


            /*
            OUTPUT:


            This is the data from a PAA-9L / 0,35bar MM0123 / 03-00006-02 with serial number 43345

            ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            The measurement data (Testrun) :
            mathematical model
            type                 PAA-9L / 0.35BAR MM0123 / ██-█████-██
            sn                   43345
            temperature range    -10 .. 80°C
            pressure range       0 .. 0.35bar ███

            date                 17.03.22
            excitation           1mA

            Version              V██.█.█.███
            -----------------------------------------------------------------------

            P = f(Sig,R); R=Rb   temp       Rb'       sig     press    p calc    deviat
                                 [°C]     [Ohm]      [mV]     [bar]     [bar]     [%Fs]
                                -10.7    3279.5    16.835     0.030     0.030      0.00
                                         3275.1    28.717     0.110     0.110     -0.01
                                         3270.7    40.562     0.190     0.190      0.00
                                         3266.5    52.355     0.270     0.270      0.01
                                         3262.3    64.089     0.350     0.350     -0.00

                                 -0.6    3349.8    17.296     0.030     0.030      0.01
                                         3345.4    29.145     0.110     0.110     -0.01
                                         3341.0    40.960     0.190     0.190      0.00
                                         3336.8    52.723     0.270     0.270      0.01
                                         3332.6    64.427     0.350     0.350     -0.01

                                 19.5    3507.9    18.276     0.030     0.030      0.00
                                         3503.4    30.120     0.110     0.110     -0.01
                                         3499.0    41.931     0.190     0.190      0.00
                                         3494.7    53.699     0.270     0.270      0.01
                                         3490.4    65.413     0.350     0.350     -0.00

                                 39.7    3684.5    19.327     0.030     0.030      0.01
                                         3680.0    31.223     0.110     0.110     -0.01
                                         3675.5    43.096     0.190     0.190      0.00
                                         3671.2    54.926     0.270     0.270      0.01
                                         3666.9    66.708     0.350     0.350     -0.01

                                 59.9    3877.5    20.448     0.030     0.030      0.00
                                         3873.0    32.439     0.110     0.110     -0.01
                                         3868.4    44.413     0.190     0.190      0.00
                                         3864.1    56.348     0.270     0.270      0.01
                                         3859.8    68.238     0.350     0.350     -0.00

                                 79.9    4085.9    21.679     0.030     0.030      0.00
                                         4081.3    33.798     0.110     0.110     -0.01
                                         4076.7    45.904     0.190     0.190      0.00
                                         4072.3    57.976     0.270     0.270      0.01
                                         4067.9    70.007     0.350     0.350     -0.00



            T = f(R,Sig)              press       Rb'    t meas    t calc    deviat
                                      [bar]     [Ohm]      [°C]      [°C]     [bar]
                                      0.030    3279.5     -10.7     -10.8      -0.1
                                      0.110    3275.1     -10.7     -10.8      -0.1
                                      0.190    3270.7     -10.7     -10.8      -0.1
                                      0.270    3266.5     -10.7     -10.8      -0.1
                                      0.350    3262.3     -10.7     -10.8      -0.1

                                      0.030    3349.8      -0.6      -0.8      -0.1
                                      0.110    3345.4      -0.6      -0.8      -0.1
                                      0.190    3341.0      -0.6      -0.8      -0.1
                                      0.270    3336.8      -0.6      -0.8      -0.1
                                      0.350    3332.6      -0.6      -0.8      -0.1

                                      0.030    3507.9      19.5      19.5       0.0
                                      0.110    3503.4      19.5      19.5      -0.0
                                      0.190    3499.0      19.5      19.5      -0.0
                                      0.270    3494.7      19.5      19.5      -0.0
                                      0.350    3490.4      19.5      19.5      -0.0

                                      0.030    3684.5      39.7      39.7      -0.0
                                      0.110    3680.0      39.7      39.7      -0.0
                                      0.190    3675.5      39.7      39.7      -0.0
                                      0.270    3671.2      39.7      39.7      -0.0
                                      0.350    3666.9      39.7      39.7      -0.0

                                      0.030    3877.5      59.9      59.9       0.1
                                      0.110    3873.0      59.9      59.9       0.1
                                      0.190    3868.4      59.9      59.9       0.1
                                      0.270    3864.1      59.9      59.9       0.1
                                      0.350    3859.8      59.9      59.9       0.1

                                      0.030    4085.9      79.9      80.0       0.1
                                      0.110    4081.3      79.9      80.0       0.1
                                      0.190    4076.7      79.9      80.0       0.1
                                      0.270    4072.3      79.9      80.1       0.1
                                      0.350    4067.9      79.9      80.1       0.1



            ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            The MathMod coefficient data   :
            mathematical model
            type                 PAA-9L / 0.35BAR MM0123 / ██-█████-██
            sn                   43345
            temperature range    -10 .. 80°C
            pressure range       0 .. 0.35bar ███

            date                 17.03.22
            excitation           1mA

            Version              V██.█.█.███
            -----------------------------------------------------------------------

            model type          P  = f(Sig,R); R=Rb
                                P = a *Sig^0 +b*Sig^1 +c*Sig^2 +...
                                a = a0*R^0   +a1*R^1  +a2*R^2  +...
                                b = b0*R^0   +b1*R^1  +b2*R^2  +...
                                c = .....

            coefficients        P = f(Sig,R); R=Rb
                                pressure polynomial    2. degree
                                temperature polynomial 4. degree

                                a0  1.85692868408E+000
                                a1 -1.76274170225E-003
                                a2  6.08504105681E-007
                                a3 -9.46199708063E-011
                                a4  5.48501841122E-015

                                b0 -9.72484450016E-002
                                b1  1.04619893035E-004
                                b2 -3.93932586974E-008
                                b3  6.58963486505E-012
                                b4 -4.14190897641E-016

                                c0 -3.73683194975E-004
                                c1  4.27054468987E-007
                                c2 -1.80529385661E-010
                                c3  3.36350195079E-014
                                c4 -2.33638757066E-018


            model type          T  = f(R,Sig)
                                T = a *R^0   +b*R^1    +c*R^2    +...
                                a = a0*Sig^0 +a1*Sig^1 +a2*Sig^2 +...
                                b = b0*Sig^0 +b1*Sig^1 +b2*Sig^2 +...
                                c = .....

            coefficients        T = f(R,Sig)
                                pressure polynomial    4. degree
                                temperature polynomial 2. degree

                                a0 -7.87518668483E+003
                                a1  4.71681063908E+000
                                a2 -3.66221497503E-002

                                b0  7.75947043698E+000
                                b1 -3.81835738619E-003
                                b2  3.48767690506E-005

                                c0 -2.93402606660E-003
                                c1  1.08338912161E-006
                                c2 -1.22673564817E-008

                                d0  5.02759289993E-007
                                d1 -1.16986520147E-010
                                d2  1.87879778498E-012

                                e0 -3.25143822494E-011
                                e1  2.92124562593E-015
                                e2 -1.04990231291E-016




            ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            The measurement data (Testrun) as CSV :
            type,PAA-9L/0.35BAR MM0123/██-█████-██
            note ,
            sn,43345
            temp range,-10 .. 80°C
            pressure range,0 .. 0.35bar ███
            date,17.03.22
            supply,1.000 mA
            Version,V██.█.█.███
            res,
            {model1}
            model type,P = f(Sig,R); R=Rb
            temp,Rb',sig,press,p calc,deviat
            [°C],[Ohm],[mV],[bar],[bar],[%Fs]
                 -10.7,    3279.5,    16.835,     0.030,     0.030,      0.00
                 -10.7,    3275.1,    28.717,     0.110,     0.110,     -0.01
                 -10.7,    3270.7,    40.562,     0.190,     0.190,      0.00
                 -10.7,    3266.5,    52.355,     0.270,     0.270,      0.01
                 -10.7,    3262.3,    64.089,     0.350,     0.350,     -0.00
                  -0.6,    3349.8,    17.296,     0.030,     0.030,      0.01
                  -0.6,    3345.4,    29.145,     0.110,     0.110,     -0.01
                  -0.6,    3341.0,    40.960,     0.190,     0.190,      0.00
                  -0.6,    3336.8,    52.723,     0.270,     0.270,      0.01
                  -0.6,    3332.6,    64.427,     0.350,     0.350,     -0.01
                  19.5,    3507.9,    18.276,     0.030,     0.030,      0.00
                  19.5,    3503.4,    30.120,     0.110,     0.110,     -0.01
                  19.5,    3499.0,    41.931,     0.190,     0.190,      0.00
                  19.5,    3494.7,    53.699,     0.270,     0.270,      0.01
                  19.5,    3490.4,    65.413,     0.350,     0.350,     -0.00
                  39.7,    3684.5,    19.327,     0.030,     0.030,      0.01
                  39.7,    3680.0,    31.223,     0.110,     0.110,     -0.01
                  39.7,    3675.5,    43.096,     0.190,     0.190,      0.00
                  39.7,    3671.2,    54.926,     0.270,     0.270,      0.01
                  39.7,    3666.9,    66.708,     0.350,     0.350,     -0.01
                  59.9,    3877.5,    20.448,     0.030,     0.030,      0.00
                  59.9,    3873.0,    32.439,     0.110,     0.110,     -0.01
                  59.9,    3868.4,    44.413,     0.190,     0.190,      0.00
                  59.9,    3864.1,    56.348,     0.270,     0.270,      0.01
                  59.9,    3859.8,    68.238,     0.350,     0.350,     -0.00
                  79.9,    4085.9,    21.679,     0.030,     0.030,      0.00
                  79.9,    4081.3,    33.798,     0.110,     0.110,     -0.01
                  79.9,    4076.7,    45.904,     0.190,     0.190,      0.00
                  79.9,    4072.3,    57.976,     0.270,     0.270,      0.01
                  79.9,    4067.9,    70.007,     0.350,     0.350,     -0.00

            {model2}
            model type,T = f(R,Sig)
            press,Rb',t meas,t calc,deviat
            [bar],[Ohm],[°C],[°C],[°C]
                0.0300,    3279.5,     -10.7,     -10.8,      -0.1
                0.1100,    3275.1,     -10.7,     -10.8,      -0.1
                0.1900,    3270.7,     -10.7,     -10.8,      -0.1
                0.2700,    3266.5,     -10.7,     -10.8,      -0.1
                0.3500,    3262.3,     -10.7,     -10.8,      -0.1
                0.0300,    3349.8,      -0.6,      -0.8,      -0.1
                0.1100,    3345.4,      -0.6,      -0.8,      -0.1
                0.1900,    3341.0,      -0.6,      -0.8,      -0.1
                0.2700,    3336.8,      -0.6,      -0.8,      -0.1
                0.3500,    3332.6,      -0.6,      -0.8,      -0.1
                0.0300,    3507.9,      19.5,      19.5,       0.0
                0.1100,    3503.4,      19.5,      19.5,      -0.0
                0.1900,    3499.0,      19.5,      19.5,      -0.0
                0.2700,    3494.7,      19.5,      19.5,      -0.0
                0.3500,    3490.4,      19.5,      19.5,      -0.0
                0.0300,    3684.5,      39.7,      39.7,      -0.0
                0.1100,    3680.0,      39.7,      39.7,      -0.0
                0.1900,    3675.5,      39.7,      39.7,      -0.0
                0.2700,    3671.2,      39.7,      39.7,      -0.0
                0.3500,    3666.9,      39.7,      39.7,      -0.0
                0.0300,    3877.5,      59.9,      59.9,       0.1
                0.1100,    3873.0,      59.9,      59.9,       0.1
                0.1900,    3868.4,      59.9,      59.9,       0.1
                0.2700,    3864.1,      59.9,      59.9,       0.1
                0.3500,    3859.8,      59.9,      59.9,       0.1
                0.0300,    4085.9,      79.9,      80.0,       0.1
                0.1100,    4081.3,      79.9,      80.0,       0.1
                0.1900,    4076.7,      79.9,      80.0,       0.1
                0.2700,    4072.3,      79.9,      80.1,       0.1
                0.3500,    4067.9,      79.9,      80.1,       0.1



            ─────────────────────────────────────────────────────────────────────────────────────────────────────────────────
            The MathMod coefficient data   as CSV :
            type,PAA-9L/0.35BAR MM0123/██-█████-██
            note ,
            sn,43345
            temp range,-10 .. 80°C
            pressure range,0 .. 0.35bar ███
            date,17.03.22
            supply,1.000 mA
            Version,V██.█.█.███
            res,
            {model1}
            model type,P  = f(Sig,R); R=Rb
            degree x,2
            degree z,4
            a0, 1.85692868408E+00
            a1,-1.76274170225E-03
            a2, 6.08504105681E-07
            a3,-9.46199708063E-11
            a4, 5.48501841122E-15
            b0,-9.72484450016E-02
            b1, 1.04619893035E-04
            b2,-3.93932586974E-08
            b3, 6.58963486505E-12
            b4,-4.14190897641E-16
            c0,-3.73683194975E-04
            c1, 4.27054468987E-07
            c2,-1.80529385661E-10
            c3, 3.36350195079E-14
            c4,-2.33638757066E-18
            {model2}
            model type,T  = f(R,Sig)
            degree x,4
            degree z,2
            a0,-7.87518668483E+03
            a1, 4.71681063908E+00
            a2,-3.66221497503E-02
            b0, 7.75947043698E+00
            b1,-3.81835738619E-03
            b2, 3.48767690506E-05
            c0,-2.93402606660E-03
            c1, 1.08338912161E-06
            c2,-1.22673564817E-08
            d0, 5.02759289993E-07
            d1,-1.16986520147E-10
            d2, 1.87879778498E-12
            e0,-3.25143822494E-11
            e1, 2.92124562593E-15
            e2,-1.04990231291E-16

            */
        }
    }
}